# ID Format Changes

## Overview
Updated the ID generation system to use standardized formats for transaction IDs and user/customer IDs.

## New ID Formats

### 1. Transaction ID / Reference
**Format:** `TKG60ACDU9` (10 characters)
- 3 uppercase letters (e.g., TKG)
- 2 digits (e.g., 60)
- 5 uppercase letters/digits mix (e.g., ACDU9)

**Example:** `TKG60ACDU9`, `ABC12XYZ34`, `MNO98PQRS5`

**Generated by:** `IdGenerator.generateTransactionId()`

### 2. Customer Number / User ID
**Format:** `123456` (6 digits)
- Simple 6-digit number
- Range: 100000 - 999999

**Example:** `123456`, `987654`, `555123`

**Generated by:**
- `IdGenerator.generateCustomerNumber()`
- `IdGenerator.generateUserId()`

### 3. Account Number (Optional)
**Format:** `ACC123456` (3 letter prefix + 6 digits)
- Default prefix: "ACC"
- Can be customized with different prefixes

**Generated by:** `IdGenerator.generateAccountNumber(prefix = "ACC")`

## Implementation Details

### Files Modified

1. **`server/src/main/kotlin/org/dals/project/utils/IdGenerator.kt`** (NEW)
   - Central utility for all ID generation
   - Contains methods for generating transaction IDs, customer numbers, user IDs, and account numbers

2. **`server/src/main/kotlin/org/dals/project/services/TransactionService.kt`**
   - Now auto-generates transaction references using the new format
   - If no reference is provided, generates one automatically
   - Both sender and receiver transactions use the same reference ID

3. **`server/src/main/kotlin/org/dals/project/services/CustomerService.kt`**
   - Updated to use 6-digit customer numbers
   - Uses `IdGenerator.generateCustomerNumber()`

### How It Works

#### Transaction Creation
```kotlin
// Automatic generation if reference not provided
val transactionReference = request.reference?.takeIf { it.isNotBlank() }
    ?: IdGenerator.generateTransactionId()

// Result: TKG60ACDU9 (or similar)
```

#### Customer Creation
```kotlin
val customerNumber = IdGenerator.generateCustomerNumber()
// Result: 123456 (or similar 6-digit number)
```

## Benefits

1. **Consistency:** All IDs follow a standard format
2. **Readability:** Shorter, easier to communicate IDs
3. **User-Friendly:** Transaction IDs are memorable and easy to reference
4. **Professional:** Matches common banking ID formats

## Migration

### For New Records
- All new transactions automatically get the new format
- All new customers automatically get 6-digit numbers
- **No action required**

### For Existing Records (Optional)
- Existing records with old formats will continue to work
- To update existing records, run the migration script:
  ```sql
  -- See: update_ids_format.sql
  ```
- **Backup database before running migration**

## Usage Examples

### Generate Transaction ID
```kotlin
val txnId = IdGenerator.generateTransactionId()
// Output: "TKG60ACDU9"
```

### Generate Customer Number
```kotlin
val customerNum = IdGenerator.generateCustomerNumber()
// Output: "123456"
```

### Generate Account Number
```kotlin
val accountNum = IdGenerator.generateAccountNumber("SAV")
// Output: "SAV123456"
```

## Testing

All new transactions and customers will automatically use the new format. Test by:

1. Creating a new transaction → Check the `reference` field
2. Creating a new customer → Check the `customer_number` field
3. Viewing transaction history → All new transactions show the new format

## Notes

- Old format IDs remain valid and functional
- The system is backward compatible
- No breaking changes to existing functionality
- Transaction references are unique per transaction
- Customer numbers avoid conflicts with simple random generation
